---
import Container from '@/components/common/Container.astro';
import ProjectCard from '@/components/ui/ProjectCard.astro';
import Button from '@/components/common/Button.astro';
import { getCollection } from 'astro:content';
import type { Project } from '@/types';

const projects = await getCollection('projects');

const projectsData: Project[] = projects
  .filter(p => p.data.featured)
  .slice(0, 3)
  .map(p => ({
    slug: p.slug,
    title: p.data.title,
    description: p.data.description,
    publishDate: p.data.publishDate,
    featured: p.data.featured,
    tags: p.data.tags,
    image: p.data.image,
    github: p.data.github,
    demo: p.data.demo,
    technologies: p.data.technologies
  }));
---

<section class="py-20 bg-dark relative overflow-hidden">
  <!-- Background effects -->
  <div class="absolute inset-0 grid-pattern opacity-50"></div>
  <div class="absolute top-0 left-0 w-full h-0.5 bg-linear-to-r from-transparent via-primary to-transparent"></div>
  
  <Container>
    <div class="text-center mb-12 relative">
      <h2 class="text-4xl md:text-6xl font-black text-white mb-4">
        Proyectos <span class="text-primary text-glow">Destacados</span>
      </h2>
      <p class="text-xl text-gray-400 max-w-2xl mx-auto">
        Algunos de los proyectos en los que he trabajado recientemente
      </p>
    </div>
    
    {projectsData.length > 0 ? (
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {projectsData.map(project => (
          <ProjectCard project={project} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-gray-500">No hay proyectos disponibles en este momento.</p>
      </div>
    )}
    
    <div class="text-center">
      <Button href="/projects" variant="outline" size="lg">
        Ver Todos los Proyectos
      </Button>
    </div>
  </Container>
</section>
