---
import Container from '@/components/common/Container.astro';
import ProjectCard from '@/components/ui/ProjectCard.astro';
import Button from '@/components/common/Button.astro';
import { getCollection } from 'astro:content';
import type { Project } from '@/types';

const projects = await getCollection('projects');

const projectsData: Project[] = projects
  .filter(p => p.data.featured)
  .slice(0, 3)
  .map(p => ({
    slug: p.slug,
    title: p.data.title,
    description: p.data.description,
    publishDate: p.data.publishDate,
    featured: p.data.featured,
    tags: p.data.tags,
    image: p.data.image,
    github: p.data.github,
    demo: p.data.demo,
    technologies: p.data.technologies
  }));
---

<section class="py-20 bg-gray-50">
  <Container>
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        Proyectos Destacados
      </h2>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Algunos de los proyectos en los que he trabajado recientemente
      </p>
    </div>
    
    {projectsData.length > 0 ? (
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {projectsData.map(project => (
          <ProjectCard project={project} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-gray-500">No hay proyectos disponibles en este momento.</p>
      </div>
    )}
    
    <div class="text-center">
      <Button href="/projects" variant="outline" size="lg">
        Ver Todos los Proyectos
      </Button>
    </div>
  </Container>
</section>
